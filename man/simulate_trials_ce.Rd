% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate.R
\name{simulate_trials_ce}
\alias{simulate_trials_ce}
\title{Simulate many trials and summarize operating characteristics}
\usage{
simulate_trials_ce(
  R,
  n1,
  n2,
  delta,
  piZ,
  theta,
  eta,
  sigmaY,
  error_type = c("normal", "t", "skew"),
  muX_C,
  muX_T = NULL,
  sigmaX,
  gamma0,
  gamma1,
  mu0,
  lookup,
  pi_fixed = 0.5,
  digits_rate = 3,
  digits_effect = 4,
  digits_asn = 1
)
}
\arguments{
\item{R}{Number of replicates.}

\item{n1, n2}{Stage-1/Stage-2 per-arm sample sizes.}

\item{delta}{Treatment main effect in the Z=0 stratum.}

\item{piZ}{Stage-2 shift prevalence for Z=1.}

\item{theta}{Main effect of Z.}

\item{eta}{Interaction T:Z.}

\item{sigmaY}{SD of the primary outcome error.}

\item{error_type}{One of \code{"normal"}, \code{"t"}, \code{"skew"}.}

\item{muX_C}{Stage-1 surrogate mean in control.}

\item{muX_T}{Stage-1 surrogate mean in treatment. If \code{NULL}, it is set
internally to \code{muX_C + delta/gamma1} to align the interim mean with the
primary effect as in the paper.}

\item{sigmaX}{SD of the Stage-1 surrogate.}

\item{gamma0, gamma1}{External linear calibration coefficients for the surrogate.}

\item{mu0}{Baseline intercept for the primary outcome.}

\item{lookup}{A CE lookup object returned by \code{build_ce_lookup()}.}

\item{pi_fixed}{Design-fixed mixture prevalence used in the estimand.}

\item{digits_rate}{Integer decimals for rate-type outputs.}

\item{digits_effect}{Integer decimals for effect-type outputs.}

\item{digits_asn}{Integer decimals for sample-size outputs.}
}
\value{
A list with
\describe{
\item{results}{Replicate-level data.frame.}
\item{summary}{Numeric one-row data.frame.}
\item{summary_pretty}{Character one-row data.frame with unified decimals.}
}
}
\description{
Returns two summaries:
\itemize{
\item \code{summary}: numeric values (good for downstream calculations);
\item \code{summary_pretty}: fixed-decimal character values (good for display).
}
}
\details{
Default decimal places:
\itemize{
\item Rates (rejection_rate, early_stop_rate, coverage): 3 decimals;
\item Effects (bias, mse): 4 decimals;
\item Sample sizes (ASN_total, ASN_per_arm): 1 decimal.
}
}
