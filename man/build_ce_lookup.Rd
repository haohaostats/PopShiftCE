% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/h0_ce.R
\name{build_ce_lookup}
\alias{build_ce_lookup}
\title{Build CE lookup via H0 Monte Carlo (design-fixed target)}
\usage{
build_ce_lookup(
  n1,
  n2,
  muX_C,
  sigmaX,
  gamma0,
  gamma1,
  mu0,
  sigmaY,
  theta,
  eta,
  piZ,
  pi_fixed = 0.5,
  error_type = c("normal", "t", "skew"),
  rho_XY = 0.3,
  alpha_one_sided = 0.05,
  B_ref = 150000,
  batch_size = 5000,
  z1_grid = seq(-3.5, 3, by = 0.05),
  min_in_bin = 400,
  h0 = 0.05
)
}
\arguments{
\item{n1, n2}{Stage-1/Stage-2 per-arm sample sizes.}

\item{muX_C, sigmaX, gamma0, gamma1}{Stage-1 surrogate and calibration parameters.}

\item{mu0, sigmaY, theta, eta, piZ}{Stage-2 primary outcome and shift parameters.}

\item{pi_fixed}{Design-fixed mixture prevalence for the estimand.}

\item{error_type}{Error distribution for the primary outcome.}

\item{rho_XY}{Surrogate-primary correlation for H0 calibration.}

\item{alpha_one_sided}{Target one-sided alpha level.}

\item{B_ref}{Monte Carlo size for H0 pairing.}

\item{batch_size}{Number of simulations per batch (for progress bar).}

\item{z1_grid}{Grid of t1 values for the lookup table.}

\item{min_in_bin}{Minimum conditional sample per grid point for estimating c(t1).}

\item{h0}{Initial half-width for local neighborhoods in t1.}
}
\value{
An object of class 'ce_lookup' with elements b_ref, e_fun, c_fun, z1_grid, meta.
}
\description{
Calibrates a single reference boundary b_ref such that the reference rule
\eqn{\{T_1 \ge b\} \cup \{T_1 < b, S_{\mathrm{final}}\ge b\}} matches a one-sided alpha.
Then estimates the conditional error \eqn{e(t_1)} and the conditional critical value
\eqn{c(t_1)} from the conditional null of \eqn{S_{\mathrm{final}}|T_1=t_1}.
}
